[supervisord]
nodaemon = true
logfile = /var/log/supervisor/supervisord.log
pidfile = /var/run/supervisord.pid

; Supervisor UI (optional)
[unix_http_server]
file = /var/run/supervisor.sock

[supervisorctl]
serverurl = unix:///var/run/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

; Laravel Queue Worker Configuration
[program:laravel-queue-worker]
process_name = %(program_name)s_%(process_num)02d
command = php /var/www/html/artisan queue:work database --queue=default,high --sleep=3 --tries=3
autostart = true
autorestart = true
numprocs = 3
redirect_stderr = true
stdout_logfile = /var/log/queue-worker.log
stopwaitsecs = 3600
environment = APP_ENV=production

; Laravel Schedule Worker (Cron Job)
[program:laravel-scheduler]
process_name = %(program_name)s
command = php /var/www/html/artisan schedule:run
autostart = true
autorestart = true
numprocs = 1
redirect_stderr = true
stdout_logfile = /var/log/scheduler.log
environment = APP_ENV=production
